---
import Layout from "@layouts/Layout.astro";
import Hero from "@components/md-hero.astro";
import Container from "@components/container.astro"; 
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import { getRelativeLocaleUrl } from "astro:i18n";

// CRITICAL: Set 404 status to prevent redirect loops
Astro.response.status = 404;

// Get current language and create translation function
const safeUrl = Astro.url || new URL('/', Astro.site || 'http://localhost:4321');
const lang = getLangFromUrl(safeUrl);
const t = useTranslations(lang);

// Helper function to create localized paths
function localizePath(path: string) {
	if (!path || (path && path.startsWith('http')) || path === '#') return path;
	return getRelativeLocaleUrl(lang, path);
}

// SEO/props for Malay
const title = 'Ralat 404 - MusicallyDown - Muat turun video TikTok tanpa tanda air dalam beberapa saat';
const description = 'Oops! Halaman ini telah mengalami pengembaraan yang tidak dijangka. Nampaknya anda cuba mengakses halaman yang tidak wujud (atau telah dipindahkan).';
const image = 'meta/opengraph.webp';
const variant = '404';
---

<Layout title={title} description={description} image={image} variant={variant} lang={lang}>
<Hero />

	<Container>
		<section class="flex items-center h-full p-16">
			<div class="container flex flex-col items-center justify-center px-5 mx-auto my-8">
				<div class="max-w-md text-center">
					
					<h2 class="mb-8 font-bold text-9xl">
						<span class="sr-only">Ralat</span>
						<span class="text-primary">404</span>
					</h2>
					<p class="text-3xl font-semibold md:text-3xl">Maaf, kami tidak dapat mencari halaman ini.</p>
					<p class="mt-4 mb-8 text-lg text-muted">Tetapi jangan risau, anda boleh menemui banyak perkara lain di laman utama kami.</p>
					<a rel="noopener noreferrer" href={localizePath("/")} class="btn ml-4">Kembali ke laman utama</a>
				</div>
			</div>
		</section>
	</Container>
</Layout>